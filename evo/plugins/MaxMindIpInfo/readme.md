# Плагин для ModX Edolution. Собирает информацию об IP адресе пользователя.

Плагин собирает информацию об IP пользователя сайта для дальнейшего испотльзования.
Он ничего не делает, просто собирает инфу и сохраняет их в сессии и в куках (на 10 дней, что можно поменять в коде)
Работает на бесплатной версии от https://www.maxmind.com, что на сегодняшний день является наиболее актуальной базой IP-адресов.
Было такое на NIC.RU но они чот забыли об этом. Остальные базы все платные. Бесплатных не нашел.
Но и тут есть ограничения, но не такие как везде. Вам достаточно скачать файлы баз и ВЕЛКАМ!
Одно НО! Лицензия подразумевает некоммерческое использование!
Если иное, то пишите на адрес redcat@nxt.ru я всегда рад помочь!
Иное - на ваше усмотрение!
Вы ведь ознакомились с лицензией? 
**Лицензия https://creativecommons.org/licenses/by-sa/4.0/ Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)**<br>
Да! По лицензии от maxmind вы должны указать ссылку на сайте такого типа:
This product includes GeoLite2 data created by MaxMind, available from
<a href="https://www.maxmind.com">https://www.maxmind.com</a>.

# ВНИМАНИЕ!!!!! Плагин не работает на локальных IP адресах!!!!

Т.к. локальные адреса не индексируются.

# ОПИСАНИЕ

Плагин берет 2 основных параметра информации об IP.
Это, если есть **$_SERVER['HTTP_X_FORWARDED_FOR']** или если его нет, то **$_SERVER['REMOTE_ADDR']** 
Если уж и его нет, то всегда что-то да есть)

Сохраняет в сессии и в куках данные об IP адресе пользователя сайта для дальнейшего использования где бы то ни было.

## Установка

1. Вы можете установить данный плагин посредством стандартного уставщика ModX Evolution
2. Вы можете загрузить пакет установки, он тут

## Как посмотреть резултат работы плагина?

** Плагин выполняется на событии OnBeforeLoadDocumentObject **

Я просто не нашел события которое раньше, это в упрек разработчикам, т.к. могут и другие события происходить, что возможно происходят ранее.

Результат работы плагина сохраняется в сессии и в куках, чтоб не юзать лишний раз базу.
Вы всегда можете установить плагин и потом написать небольшой сниппет для вывода данных, что он собрал.
Мне лень писать отдельно, т.к. для каждого случая бывают разная необходимость в этом плагине.
Вы можете просто написать сниппет и вызвать его на любой странице или иное.

** небольшой пример сниппета, что выводит все данные собранные плагином, назовем его test (или как пожелаете) **

```php
<?php 
echo '<pre>';
print_r($_SESSION['MaxMindIpInfo']);
echo '</pre>';
?>
```

далее просто вызовете на странице [!test!]

### ПРИМЕЧАНИЕ
**ВАЖНО!!!**
ЕСЛИ У ВАС ВКЛЮЧЕН КЭШ НА САЙТЕ, НЕ ГАРАНТИРУЕТСЯ ПРАВИЛЬНАЯ РАБОТА ПЛАГИНА!